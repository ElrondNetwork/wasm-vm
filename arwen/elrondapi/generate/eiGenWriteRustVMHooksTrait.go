package elrondapigenerate

import (
	"fmt"
	"os"
)

func WriteVMHooksRustTrait(out *os.File, eiMetadata *EIMetadata) {
	out.WriteString("// Code generated by elrondapi generator. DO NOT EDIT.\n\n")
	out.WriteString("// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n")
	out.WriteString("// !!!!!!!!!!!!!!!!!!!!!! AUTO-GENERATED FILE !!!!!!!!!!!!!!!!!!!!!!\n")
	out.WriteString("// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n")
	out.WriteString("\n")
	out.WriteString("pub trait VMHooks: 'static {\n")

	for _, funcMetadata := range eiMetadata.AllFunctions {
		out.WriteString(fmt.Sprintf("    fn %s(&self", snakeCase(funcMetadata.Name)))
		for _, arg := range funcMetadata.Arguments {
			out.WriteString(fmt.Sprintf(", %s: %s", snakeCase(arg.Name), rustType(arg.Type)))
		}
		out.WriteString(")")
		if funcMetadata.Result != nil {
			out.WriteString(fmt.Sprintf(" -> %s", rustType(funcMetadata.Result.Type)))
		}

		out.WriteString(";\n")
	}

	out.WriteString("}\n")
}
